{"ast":null,"code":"import _defineProperty from \"@babel/runtime/helpers/defineProperty\";\nimport _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\nimport _regeneratorRuntime from \"@babel/runtime/regenerator\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); enumerableOnly && (symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; })), keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = null != arguments[i] ? arguments[i] : {}; i % 2 ? ownKeys(Object(source), !0).forEach(function (key) { _defineProperty(target, key, source[key]); }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)) : ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } return target; }\n\nimport React, { useState } from \"react\";\nimport View from \"react-native-web/dist/exports/View\";\nimport Text from \"react-native-web/dist/exports/Text\";\nimport Alert from \"react-native-web/dist/exports/Alert\";\nimport styles from \"./styles\";\nimport LoginComponent from \"./Login.component\";\nimport { useNavigation } from \"@react-navigation/native\";\nimport { Constants } from \"../../common\";\nimport { login } from \"../../client/index\";\nimport AsyncStorage from \"@react-native-async-storage/async-storage\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nvar invalidCredentialsModalIntialState = {\n  title: Constants.language.generic.sorry,\n  subtitle: Constants.language.screensText.login.rejected,\n  primaryButtonLabel: Constants.language.generic.accept,\n  isModalVisible: false\n};\n\nvar LoginScreen = function LoginScreen(props) {\n  var navigation = useNavigation();\n\n  var _useState = useState(\"\"),\n      _useState2 = _slicedToArray(_useState, 2),\n      user = _useState2[0],\n      setUser = _useState2[1];\n\n  var _useState3 = useState(\"\"),\n      _useState4 = _slicedToArray(_useState3, 2),\n      password = _useState4[0],\n      setPassword = _useState4[1];\n\n  var _useState5 = useState(false),\n      _useState6 = _slicedToArray(_useState5, 2),\n      showSpinner = _useState6[0],\n      setShowSpinner = _useState6[1];\n\n  var _useState7 = useState(invalidCredentialsModalIntialState),\n      _useState8 = _slicedToArray(_useState7, 2),\n      invalidModal = _useState8[0],\n      setInvalidModal = _useState8[1];\n\n  var delay = function delay(ms) {\n    return new Promise(function (res) {\n      return setTimeout(res, ms);\n    });\n  };\n\n  var handlePressNext = function _callee() {\n    var res;\n    return _regeneratorRuntime.async(function _callee$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            if (!(user == \"\" || password == \"\")) {\n              _context.next = 4;\n              break;\n            }\n\n            Alert.alert(Error, \"Faltan datos\");\n            _context.next = 21;\n            break;\n\n          case 4:\n            setShowSpinner(true);\n            _context.next = 7;\n            return _regeneratorRuntime.awrap(login(user, password));\n\n          case 7:\n            res = _context.sent;\n            setShowSpinner(false);\n\n            if (!(res == \"\")) {\n              _context.next = 13;\n              break;\n            }\n\n            setInvalidModal(_objectSpread(_objectSpread({}, invalidModal), {}, {\n              isModalVisible: true\n            }));\n            _context.next = 21;\n            break;\n\n          case 13:\n            console.log(\"id\", res[0].id);\n            _context.next = 16;\n            return _regeneratorRuntime.awrap(AsyncStorage.setItem(\"@id\", \"\" + res[0].id));\n\n          case 16:\n            _context.next = 18;\n            return _regeneratorRuntime.awrap(AsyncStorage.setItem(\"@username\", res[0].username));\n\n          case 18:\n            _context.next = 20;\n            return _regeneratorRuntime.awrap(AsyncStorage.setItem(\"@email\", res[0].email));\n\n          case 20:\n            navigation.push(Constants.screens.Home);\n\n          case 21:\n          case \"end\":\n            return _context.stop();\n        }\n      }\n    }, null, null, null, Promise);\n  };\n\n  var acceptModal = function acceptModal() {\n    setInvalidModal(_objectSpread(_objectSpread({}, invalidModal), {}, {\n      isModalVisible: false\n    }));\n  };\n\n  return _jsx(LoginComponent, {\n    handlePressNext: handlePressNext,\n    user: user,\n    password: password,\n    setUser: setUser,\n    setPassword: setPassword,\n    invalidModal: invalidModal,\n    acceptModal: acceptModal,\n    showSpinner: showSpinner\n  });\n};\n\nexport default LoginScreen;","map":{"version":3,"names":["React","useState","styles","LoginComponent","useNavigation","Constants","login","AsyncStorage","invalidCredentialsModalIntialState","title","language","generic","sorry","subtitle","screensText","rejected","primaryButtonLabel","accept","isModalVisible","LoginScreen","props","navigation","user","setUser","password","setPassword","showSpinner","setShowSpinner","invalidModal","setInvalidModal","delay","ms","Promise","res","setTimeout","handlePressNext","Alert","alert","Error","console","log","id","setItem","username","email","push","screens","Home","acceptModal"],"sources":["/Users/macintosh/Documents/Proyectos/equitec_mobile/src/screens/Login/Login.screen.jsx"],"sourcesContent":["import React, { useState } from \"react\";\nimport { View, Text, Alert } from \"react-native\";\nimport styles from \"./styles\";\nimport LoginComponent from \"./Login.component\";\nimport { useNavigation } from \"@react-navigation/native\";\nimport { Constants } from \"../../common\";\nimport { login } from \"../../client/index\";\nimport AsyncStorage from \"@react-native-async-storage/async-storage\";\n\nconst invalidCredentialsModalIntialState = {\n  title: Constants.language.generic.sorry,\n  subtitle: Constants.language.screensText.login.rejected,\n  primaryButtonLabel: Constants.language.generic.accept,\n  isModalVisible: false,\n};\nconst LoginScreen = (props) => {\n  const navigation = useNavigation();\n\n  const [user, setUser] = useState(\"\");\n  const [password, setPassword] = useState(\"\");\n  const [showSpinner, setShowSpinner] = useState(false);\n  const [invalidModal, setInvalidModal] = useState(\n    invalidCredentialsModalIntialState\n  );\n\n  const delay = (ms) => new Promise((res) => setTimeout(res, ms));\n  const handlePressNext = async () => {\n    if (user == \"\" || password == \"\") {\n      Alert.alert(Error, \"Faltan datos\");\n    } else {\n      setShowSpinner(true);\n      const res = await login(user, password);\n      setShowSpinner(false);\n      if (res == \"\") {\n        setInvalidModal({\n          ...invalidModal,\n          isModalVisible: true,\n        });\n      } else {\n        console.log(\"id\", res[0].id);\n        await AsyncStorage.setItem(\"@id\", \"\" + res[0].id);\n        await AsyncStorage.setItem(\"@username\", res[0].username);\n        await AsyncStorage.setItem(\"@email\", res[0].email);\n        navigation.push(Constants.screens.Home);\n      }\n    }\n  };\n\n  const acceptModal = () => {\n    setInvalidModal({\n      ...invalidModal,\n      isModalVisible: false,\n    });\n  };\n  return (\n    <LoginComponent\n      handlePressNext={handlePressNext}\n      user={user}\n      password={password}\n      setUser={setUser}\n      setPassword={setPassword}\n      invalidModal={invalidModal}\n      acceptModal={acceptModal}\n      showSpinner={showSpinner}\n    />\n  );\n};\n\nexport default LoginScreen;\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}